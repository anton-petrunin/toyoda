\documentclass{article}
\usepackage{quad}

\begin{document}


\title{Five points in a CAT(0) space after  Tetsu Toyoda}
\author{Nina Lebedeva and Anton Petrunin}
%\address{Anton Petrunin, Math. Dept., PSU,University Park, PA 16802, USA.}\address{petrunin@math.psu.edu}
\date{}
\maketitle
\begin{abstract}
We give another proof of Toyoda's theorem that gives a nessesary and sufficient condition for the existance of a distance preserving map from a given 5-point metric space to a $\CAT(0)$ space. 
\end{abstract}

\section{Introduction}

The $\CAT(0)$ comparison is a certain inequality for 6 distances between 4 points in a metric space; here is one way to define it:

\begin{thm}{Definition}
A quadruple of points $(p_1,p_2,x_1,x_2)$ in a metric space $X$ satisfies $\CAT(0)$ comparison
if there is quadruple of points $(\~p_1,\~p_2,\~x_1,\~x_2)$ in the Euclidean space $\EE^3$ such that 
\begin{align*}
|p_1-p_2|_{X}&\le|\~p_1-\~p_2|_{\EE^3},
\\ 
|x_1-x_2|_{X}&\le|\~x_1-\~x_2|_{\EE^3},
\\ 
|p_i-x_j|_{X}&\ge|\~p_i-\~x_j|_{\EE^3},
\end{align*}
for any $i$ and $j$.

A metric space $X$ is called $\CAT(0)$ if every quadruple of points in $X$ satisfies $\CAT(0)$ comparison.
\end{thm}

The definition above is equivalent to the (2+2)-point comparison in \cite{alexander-kapovitch-petrunin}
where other definitions and their equivalence are discussed as well.
Note that we do not assume that $\CAT(0)$ is a length space;
for example any 3 point metric space is $\CAT(0)$.


It is not hard to check that if a quadruple of points satisfies $\CAT(0)$ comparison for all relabeling,
then it admits a distance-preserving inclusion into a length $\CAT(0)$ space.
The following theorem generalizes this statement to 5 point metric spaces.

\begin{thm}{Toyoda's theorem}
Let $P$ be a 5 point metric space that satisfies $\CAT(0)$ comparison.
Then $P$ admits a distance-preserving inclusion into a $\CAT(0)$ length space $X$.

Moreover,
$X$ can be chosen to be a subcomplex of a 4-simplex such that (1) each simplex in $X$ has Euclidean metric and (2) the inclusion maps the 5 points on $P$ to the vertexes of the 4-simplex.
\end{thm}

This theorem was proved by Tetsu Toyoda \cite{toyoda};
we present a shorter and more conceptual proof.
The proof uses the fact that convex space-like hypersurfaces in $\RR^{3,1}$ equipped with the induced length metrics are $\CAT(0)$ spaces.
We construct a distance-preserving inclusion $\iota$ of $P$ into $\RR^4$ or $\RR^{3,1}$.
In the case of $\RR^4$ the convex hull of $\iota(P)$ can be taken as $X$;
in the case of $\RR^{3,1}$ we take as $X$ a certain convex space-like hypersurface in $\RR^{3,1}$.

\section{5-point arrays in 3-space}

Denote by $\mathcal{A}$ the space of all $5$ point arrays in $\RR^3$ such that all 5 points do not lie on one plane and no three points lie on one line.
Note that $\mathcal{A}$ is connected.

The space $\mathcal{A}$ can be subdivided into 7 subsets with combinatoric configuration as on the diagram;
quadruples in one plane are marked in gray.

\begin{figure}[h!]
\centering
\begin{lpic}[t(-0mm),b(2mm),r(0mm),l(0mm)]{asy/A}
\lbl[t]{6,0;$\mathcal{A}_{-3}$} 
\lbl[t]{24,0;$\mathcal{A}_{-2}$} 
\lbl[t]{42,0;$\mathcal{A}_{-1}$} 
\lbl[t]{60,0;$\mathcal{A}_{0}$} 
\lbl[t]{78,0;$\mathcal{A}_{1}$} 
\lbl[t]{96,0;$\mathcal{A}_{2}$} 
\lbl[t]{114,0;$\mathcal{A}_{3}$} 
\end{lpic}
\end{figure}

Namely, a $5$ point array  $(x_1,x_2,x_3,x_4,x_5)$ defines an affine map from a 4-simplex to $\RR^3$.
The 4-simplex has 5 facets, and each facet may be mapped in an orientation-preserving, degenerate, or orientation-reversing way.
Denote by $n_+$, $n_0$ and $n_-$ the number of orientation-preserving, degenerate, or orientation-reversing facets respectively.

Clearly $n_++n_0+n_-=5$ and since all 5 points cannot lie in one plane, we have that $n_+\ge 1$, $n_-\ge 1$, and $n_0\le1$.
Therefore the value $m=n_--n_+$ can take an integer value between $-3$ and $3$, in this case we say that an array belong so $\mathcal{A}_m$.


Every two quadraliterals in the array have 3 common points that define a plane.
If the reaming two points lie on the opposite sides from the plane then the corresponding facets have the same orientation, if they lie on one side then the orientations are opposite.
Therefore the 7 subsets $\mathcal{A}_{-3},\dots \mathcal{A}_{3}$ can be described the following way:

$\mathcal{A}_{-3}$ --- a tetrahedron with reversed orientation and one point inside.

$\mathcal{A}_{-2}$ --- a tetrahedron with reversed orientation and one point on a facet.

$\mathcal{A}_{-1}$ --- double triangular pyramid formed by two tetrahedrons with reversed orientation.

$\mathcal{A}_{0}$ --- a pyramid over a convex quadraliteral 

$\mathcal{A}_{1}$ --- double triangular pyramid formed by two tetrahedrons with preserved orientation.

$\mathcal{A}_{2}$ --- a tetrahedron with preserve orientation and one point on a facet.

$\mathcal{A}_{3}$ --- a tetrahedron with preserved orientation and one point inside.

Note that the complement $\spc{A}\backslash \spc{A}_0$ has two connected components formed by $\mathcal{A}_{-}=\mathcal{A}_{-3}\cup \mathcal{A}_{-2}\cup\mathcal{A}_{-1}$ and $\mathcal{A}_{+}=\mathcal{A}_{3}\cup \mathcal{A}_{2}\cup\mathcal{A}_{1}$.
Observe that each array in $\mathcal{A}_{-}$ has at least 3 positively oriented facets and each array in $\mathcal{A}_{+}$ has at least 3 negatively oriented facets.

\begin{thm}{Observation}\label{obs:connectedA}
If a connected subset $Q$ of $\spc{A}$ does not inersect $\spc{A}_0$.
Then either $Q\subset \spc{A}_+$ or $Q\subset \spc{A}_-$
\end{thm}


\section{Associated form}

In this section we recall some facts \cite{petrunin-2017} about the so called \emph{asociated} form;
it is a quadratic form 
$W_{\bm{x}}$ on $\RR^{n-1}$ associated
to a given $n$-point array $\bm{x}\z=(x_1,\dots,x_n)$ in a metric space $X$.

Fix a nondegenerate simplex $\triangle$ in $\RR^{n-1}$.
Denote by $v_1,\dots,v_n$ its vertices.
If $(e_1,\dots,e_{n-1})$ is the standard basis on $\RR^{n-1}$,
we may assume that $v_i=e_i$ for $i<n$ and $v_n=0$.

Let us denote by $|a-b|_X$ the distance between points $a$ and $b$ in the metric space $X$.
Set
\[W_{\bm{x}}(v_i-v_j)=|x_i-x_j|^2_X\] 
for all $i$ and $j$.
Note that this identity define $W_{\bm{x}}$ uniquely.


The constructed quadratic form $W_{\bm{x}}$ will be called \emph{form of the point array $\bm{x}$ with respect to the simplex $\triangle$}.

Note that an array $\bm{x}=(x_1,\dots,x_n)$ in a metric space $X$ is isometric to an array in Euclidean space if and only if 
$W_{\bm{x}}(v)\ge 0$
for any $v\in \RR^{n-1}$.

In particular,  the
condition $W_{\bm{x}}\ge 0$ for triples of points means that 
all three triangle inequalities hold.
The following statement is an equivalent reformulation:

\begin{thm}{Observation}\label{triangle-inq}
Suppose $L$ be a subspace of $\RR^{n-1}$ such that
$W_{\bm{x}}(v)< 0$ for any nonzero vector $v\in L$.
Then in the projections of any 3 vertexes of $\triangle$ to the quotient space $\RR^{n-1}/L$ form a nondegenerate triangle.
\end{thm}

Now let us discuss the relation between form of quadruples
and geometry of the space.
In this case $\triangle$ is a tetrahedron on $\RR^3$.

From the $3$-point case, 
it follows that $W_{\bm{x}}$ 
is nonnegative on every plane parallel to a face of the tetrahedron $\triangle$.
In particular, $W_{\bm{x}}$ can have at most one negative eigenvalue.

Assume $W_{\bm{x}}(w)<0$ for some $w\in\RR^3$.
From \ref{triangle-inq},
$w$ is transversal to each of 4 planes parallel to a faces of $\triangle$.

Consider the projection of $\triangle$ along $w$ to a transversal plane. 
Note that in the projection the 4 vertices of $\triangle$ lie in general position; 
that is, no three of them lie on one line.
Therefore  we can see one of two combinatorial pictures shown on the diagram.
It is easy to see that the combinatorics of the picture does not depend on the choice of $w$.

\begin{wrapfigure}{r}{33mm}
\vskip-4mm
\centering
\includegraphics{mppics/pic-10}
\end{wrapfigure}


\begin{thm}{Observation}\label{cat0-proj}
Suppose a metric on $\bm{x}\z=(x_1,\dots,x_n)$ satisfies $\CAT(0)$ condition
and $W_{\bm{x}}$ is its asociated form on $\RR^{n-1}$.
Assume that $L$ is a subspace of $\RR^{n-1}$ such that
$W_{\bm{x}}(v)< 0$ for any nonzero vector $v\in L$.
Then if the projections of 4 vertexes of $\triangle$ to the quotient space $\RR^{n-1}/L$ lies in one plane, then its projection looks like the picture on the left;
that is, one of the points lies in the triangle formed by the remaining three points.
\end{thm}

\begin{thm}{Corollary}\label{cor:3+2}
Suppose a metric on $\bm{x}=(x_1,\dots,x_5)$ satisfies $\CAT(0)$ condition
and $W_{\bm{x}}$ is its asociated form on $\RR^{4}$.
Assume that $L$ is a subspace of $\RR^{4}$ such that
$W_{\bm{x}}(v)< 0$ for any nonzero vector $v\in L$.
Then $\dim L\le 1$.

Moreover, if $\dim L= 1$, then the projections of $\bm{x}=(x_1,\dots,x_5)$ vertexes of $\triangle$ to the quotient space $\RR^3=\RR^4/L$ belongs to $\spc{A}\backslash\spc{A}_0$. 
\end{thm}

\parit{Proof.}
If $\dim L\ge 2$, then the space $\dim \RR^4/L\le 2$, so the projections of $x_1,\dots,x_5$.
By \ref{triangle-inq}, these 5 projections lie in a general position; that is, non three of theses projections lie on one line. 
Therefore $\dim \RR^4/L$ is the plane.

Note that from 5 points in a general position on the plane one can choose 4 that form a convex quadrangle.
The latter contradicts \ref{cat0-proj}.
\qeds

\section{Convex spacelike surfaces}

Let $W$ be a quadratic form on $\RR^3$.
Suppose that the diagonalization of $W$ has exactly one negative value on the diagonal.

Choose future and past cones $C^+$ and $C^-$ for $W$;
that is $C^+$ and $C^-$ are connceted components of the set
$\set{v\in\RR^3}{W(v)< 0}$.
A subsset $S$ in $\RR^3$ will be called \emph{spacelike} if $W(x-y)\ge 0$ for any $x,y\in S$.

\begin{wrapfigure}{r}{53mm}
\vskip-4mm
\centering
\includegraphics{mppics/pic-20}
\end{wrapfigure}

Let $K$ be a convex body in $\RR^4$;
denote by $\Sigma$ the surface of $K$. 
We say that $p\in \Sigma$ lies on the upper side of $\Sigma$ (briefly $p\in\Sigma^+$) if there is a space-like hyperplane in $\RR^4$ that supports $\Sigma$ at $p$ from above;
equivalently if $p+C^+$ does not intersect $K$.

Similarly we define lower side of $\Sigma$ denoted by $\Sigma^-$.
Note that $\Sigma^+$ and $\Sigma^-$ might have common points.
The subsets $\Sigma^+$ and $\Sigma^-$ are spacelike;
in particular the length of any Lipschitz curve in these subsets can be defined and it leads to induced intrinsic (pseudo)metric on $\Sigma^+$ and $\Sigma^-$. 

\begin{thm}{Lemma}\label{lem:sides}
Let $\Sigma$ be the surface of a convex body $K$ in $\RR^4$.
Then its upper and lower sides $\Sigma^+$ and $\Sigma^-$ equipped with induced intrinsic metric are a $\CAT(0)$ length spaces. 
\end{thm}

\parit{Proof.}
Applying Gauss formula, we see that a smooth convex space-like hypersurface in $\RR^4$ has nonpositive curvature.
Therefore any complete smooth convex space-like hypersurface in $\RR^4$ is $\CAT(0)$.

Note that $K^-=K+C^+$ a convex set and its boundary $\partial K^-$ is weakly space-like.
The surface $\partial K^-$ contains $\Sigma^-$ as a subset.
Moreover the induced length pseudometric on $\partial K^-$ is isometric to $\Sigma^-$.
Indeed every point of $\partial K^-$ either belongs to  $\Sigma^-$, or lies on a light ray emerging from $\Sigma^-$.
The statement follows since light rays have zero length.

Observe that $\partial K^-$ can be approximated by smooth space-like convex hypersurfaces.
In particular any 4-point subspace in $\partial K^-$ can be approximated by 4 -point subspaces in $\CAT(0)$ space.
Whence the $\CAT(0)$ comparison holds for all quadruples.
\qeds




Assume $v$ is a nonzero vector in $\RR^4$ and $p\in\Sigma$.
We say that $p$ lies on upper side of $\Sigma$ with respect to $v$ (briefly $p\in \Sigma^+(v)$) if $p+t\cdot v\notin K$ for any $t>0$.
Correspondingly, $p$ lies on lower side of $\Sigma$ with respect to $v$ (briefly $p\in \Sigma^-(v)$) if $p+t\cdot v\notin K$ for any $t<0$.

\begin{thm}{Observation}\label{obs:Sigma(v)}
Let $K$ be a compact convex set in $\RR^4$ and $C^\pm$ be the future and past cones for a quadratic form $W$.
Then the upper and lower side of the boundary surface $\Sigma$ of $K$ can be described as intersection of upper and lower sides of $\Sigma$ with respect to all vectors $v\in C^+$;
that is,
\[\Sigma^\pm=\bigcap_{v\in C^+}\Sigma^\pm(v).\]
\end{thm}

\section{Proof assembling}

\parit{Proof of Toyoda's theorem.}
Let $\{x_1,\dots,x_5\}$ be the points in $P$.
Choose a 5-simplex $\triangle$ in $\RR^4$; denote by $W$ the form associated to the point array $(x_1,\dots,x_5)$.

If $W\ge0$, then $P$ admits a distance preserving embedding into euclidean 4-space, so one can take the convex hull of its image as $X$.

Suppose $W(v)<0$ for some $v\in\RR^4$.
Since $P$ is $\CAT(0)$, \ref{cor:3+2} implies that $W$ has at most one negative value in its diagonalization.
Moreover if a line $L$ is spanned by a vector $v$ such that $W(v)<0$, then the projection of the vertexes of the simplex to $\RR^3=\RR^4/L$ belongs to $\spc{A}\backslash\spc{A}_0$.

The space of such lines $L$ is connected.
By \ref{obs:connectedA}, we can assume that all the projections belong to $\spc{A}_-$.
That is, we can choose timelike orientation such that for any $v\in C^+$ the lower part $\Sigma^-(v)$ of $\Sigma=\partial \triangle$ has at least 3 facets of $\triangle$.

In particular, $\Sigma^-(v)$ contains all edges of $\triangle$ for any $v\in C^+$.
By \ref{obs:Sigma(v)}, $\Sigma^-$ contains all edges of $\triangle$.
By \ref{lem:sides}, $\Sigma^-$ with induced (pseudo)metric is a length $\CAT(0)$ space.

Since all edges of $\triangle$ lie in $\Sigma^-$, the inclusion $P\hookrightarrow \Sigma^-$ is distance preserving.
Whence we can take $X=\Sigma^-$.
\qeds

{\sloppy
\printbibliography[heading=bibintoc]
\fussy
}
\end{document}
